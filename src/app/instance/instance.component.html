<main>
	<header>
		<form>
			<mat-form-field appearance="fill">
				<mat-label>{{"wähle Instanz"|translate}}</mat-label>
				<mat-select [formControl]="instanceNamen">
					<mat-option *ngFor="let instance of instanceNamenList|async" [value]="instance">
						<a mat-list-item routerLink="/instance/{{instance}}">{{instance}}</a>
					</mat-option>
				</mat-select>
			</mat-form-field>
			<span class="badge"></span>
			<button type="button" (click)="openFilterDialog()">{{"Filtern"|translate}}</button>
		</form>
	</header>
	<!-- ------------------------------------>

	<body>
		<h2>{{"Die Instanzen"|translate}}: </h2>
		<app-grid>
			<app-tile [ngClass]="setInst(instance.name)"
				*ngFor="let instance of filteredInstancesObservable|async; let i = index;">
				<span>
					<a routerLink="/instance/{{instance.name}}">
						<span class="badge">{{instance.name}}</span>
					</a>
					<ng-container *ngIf="instance.status === 'stopped'">
						<span> {{"Diese Instanz ist offline"|translate }}</span>
					</ng-container>
					<ng-container *ngIf="!(instance.status === 'stopped') ">
						<ng-container *ngIf="isRunningGreen(getStatus(instance))">
							{{"Alles läuft!"|translate}}
						</ng-container>
						<ng-container *ngIf="isRunningYellow(getStatus(instance))">
							{{"Langsame Services:"|translate}}
							<ul *ngFor="let service of instance.services">
								<li *ngIf="isRunningYellow(service.status)">
									<div>{{service.name}}</div>
								</li>
							</ul>
						</ng-container>
						<ng-container *ngIf="isRunningRed(getStatus(instance))">
							{{"Error Services:"|translate}}
							<ul *ngFor="let service of instance.services">
								<li *ngIf="isRunningRed(service.status)">
									<div>{{service.name}}</div>
								</li>
							</ul>
							<ng-container *ngIf="isRunningYellow(getStatus(instance))">
								{{"Langsame Services:"|translate}}
								<ul *ngFor="let service of instance.services">
									<li *ngIf="isRunningYellow(service.status)">
										<div>{{service.name}}</div>
									</li>
								</ul>
							</ng-container>
						</ng-container>
					</ng-container>
				</span>
			</app-tile>
		</app-grid>

		<h2>{{"Schlechtester Status jeder Instanz"|translate}}: </h2>
		<app-grid>
			<app-tile [ngClass]="setInstEmpty()" *ngFor="let instance of filteredInstancesObservable|async">
				<ng-container>
					<canvas class="dot_{{getStatus(instance)}}"> </canvas>
					&nbsp;
				</ng-container>
				<a routerLink="/instance/{{instance.name}}">
					<span class="badge">{{instance.name}}</span>
				</a>
				<br>
			</app-tile>
		</app-grid>
	</body>
</main>

<ng-template #worstStatus> </ng-template>